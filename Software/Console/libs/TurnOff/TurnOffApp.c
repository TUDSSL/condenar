#include "TurnOffApp.h"
#include "Kernel.h"
#include "TimeKeeper.h"
#include "Kernel_Draw.h"
#include "stdlib.h"
#include "PinDefinitions.h"
#include "Helpers/Misc.h"
#include "k_ppr.h"

void TurnOff_Update();
void TurnOff_Render();

uint8_t Sleeping_Icon[];


void TurnOffEntryPoint(){   
    while(!k_getShouldCurrentAppExit()){
        TurnOff_Update();
        TurnOff_Render();
    }
}

void TurnOff_Update(){
}



void TurnOff_Render(){
    k_BeginScreenUpdate();
    k_draw_Clear(K_COLOR_WHITE);
    k_draw_DrawImage(SCREEN_WIDTH_REAL/2 - 50, SCREEN_HEIGHT_REAL/2 - 50 - 20, 50,50,2,Sleeping_Icon);
    k_draw_DrawTextCentered(SCREEN_WIDTH_REAL/2,SCREEN_HEIGHT_REAL/2 + 50,1,"Press the power button to wake up");

    //Disable all checkpoints, forcing a normal boot    
    k_markCheckpointAsInvalid(0);
    k_markCheckpointAsInvalid(1);
    
   // k_EndScreenUpdate(false,false); //No checkpoints here ovb :)

    //GPIO_SetLevel(PIN_3V3_LA_DIS, true);
    //DelayMS(1000);

	PowerEverythingDown(false);
}


CHECKPOINT_EXCLUDE_DATA uint8_t TurnOff_Icon[] = {
    0xff, 0xff, 0xfe, 0x1f, 0xff, 0xff, 0xc0, 0xff, 0xff, 0xfc, 0x0f, 0xff, 0xff, 0xc0, 0xff, 0xff, 
	0xfc, 0x0f, 0xff, 0xff, 0xc0, 0xff, 0xff, 0xfc, 0x0f, 0xff, 0xff, 0xc0, 0xff, 0xff, 0xfc, 0x0f, 
	0xff, 0xff, 0xc0, 0xff, 0xff, 0xfc, 0x0f, 0xff, 0xff, 0xc0, 0xff, 0xff, 0xfc, 0x0f, 0xff, 0xff, 
	0xc0, 0xff, 0xff, 0xfc, 0x0f, 0xff, 0xff, 0xc0, 0xff, 0xff, 0xfc, 0x0f, 0xff, 0xff, 0xc0, 0xff, 
	0xf3, 0xfc, 0x0f, 0xf3, 0xff, 0xc0, 0xff, 0xc0, 0xfc, 0x0f, 0xc0, 0xff, 0xc0, 0xff, 0x80, 0xfc, 
	0x0f, 0xc0, 0x7f, 0xc0, 0xff, 0x00, 0xfc, 0x0f, 0xc0, 0x3f, 0xc0, 0xfe, 0x00, 0xfc, 0x0f, 0xc0, 
	0x1f, 0xc0, 0xfe, 0x00, 0xfc, 0x0f, 0xc0, 0x1f, 0xc0, 0xfc, 0x01, 0xfc, 0x0f, 0xe0, 0x0f, 0xc0, 
	0xf8, 0x03, 0xfc, 0x0f, 0xf0, 0x07, 0xc0, 0xf8, 0x07, 0xfc, 0x0f, 0xf8, 0x07, 0xc0, 0xf0, 0x0f, 
	0xfc, 0x0f, 0xfc, 0x03, 0xc0, 0xf0, 0x1f, 0xfc, 0x0f, 0xfe, 0x03, 0xc0, 0xf0, 0x1f, 0xfc, 0x0f, 
	0xfe, 0x03, 0xc0, 0xe0, 0x3f, 0xfe, 0x3f, 0xff, 0x01, 0xc0, 0xe0, 0x3f, 0xff, 0xff, 0xff, 0x01, 
	0xc0, 0xe0, 0x3f, 0xff, 0xff, 0xff, 0x01, 0xc0, 0xe0, 0x7f, 0xff, 0xff, 0xff, 0x81, 0xc0, 0xe0, 
	0x7f, 0xff, 0xff, 0xff, 0x81, 0xc0, 0xe0, 0x7f, 0xff, 0xff, 0xff, 0x81, 0xc0, 0xe0, 0x7f, 0xff, 
	0xff, 0xff, 0x80, 0xc0, 0xe0, 0x7f, 0xff, 0xff, 0xff, 0x81, 0xc0, 0xe0, 0x7f, 0xff, 0xff, 0xff, 
	0x81, 0xc0, 0xe0, 0x7f, 0xff, 0xff, 0xff, 0x81, 0xc0, 0xe0, 0x3f, 0xff, 0xff, 0xff, 0x01, 0xc0, 
	0xe0, 0x3f, 0xff, 0xff, 0xff, 0x01, 0xc0, 0xe0, 0x3f, 0xff, 0xff, 0xff, 0x01, 0xc0, 0xf0, 0x1f, 
	0xff, 0xff, 0xfe, 0x03, 0xc0, 0xf0, 0x1f, 0xff, 0xff, 0xfe, 0x03, 0xc0, 0xf0, 0x0f, 0xff, 0xff, 
	0xfc, 0x03, 0xc0, 0xf8, 0x07, 0xff, 0xff, 0xf8, 0x07, 0xc0, 0xf8, 0x03, 0xff, 0xff, 0xf0, 0x07, 
	0xc0, 0xfc, 0x01, 0xff, 0xff, 0xe0, 0x0f, 0xc0, 0xfe, 0x00, 0xff, 0xff, 0xc0, 0x1f, 0xc0, 0xfe, 
	0x00, 0x3f, 0xff, 0x00, 0x1f, 0xc0, 0xff, 0x00, 0x0f, 0xfc, 0x00, 0x3f, 0xc0, 0xff, 0x80, 0x00, 
	0x00, 0x00, 0x7f, 0xc0, 0xff, 0xc0, 0x00, 0x00, 0x00, 0xff, 0xc0, 0xff, 0xf0, 0x00, 0x00, 0x03, 
	0xff, 0xc0, 0xff, 0xf8, 0x00, 0x00, 0x07, 0xff, 0xc0, 0xff, 0xfe, 0x00, 0x00, 0x1f, 0xff, 0xc0, 
	0xff, 0xff, 0x80, 0x00, 0x7f, 0xff, 0xc0, 0xff, 0xff, 0xf0, 0x03, 0xff, 0xff, 0xc0
};

CHECKPOINT_EXCLUDE_DATA uint8_t Sleeping_Icon[] = {
    0xff, 0xff, 0xff, 0xff, 0xfc, 0x00, 0xc0, 0xff, 0xff, 0xff, 0xff, 0xfc, 0x00, 0xc0, 0xff, 0xff, 
	0xff, 0xff, 0xfc, 0x01, 0xc0, 0xff, 0xff, 0xff, 0xff, 0xff, 0xe3, 0xc0, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xc3, 0xc0, 0xff, 0xff, 0xf8, 0xff, 0xff, 0xc7, 0xc0, 0xff, 0xff, 0x00, 0xff, 0xff, 0x87, 
	0xc0, 0xff, 0xfc, 0x03, 0xff, 0xff, 0x8f, 0xc0, 0xff, 0xf0, 0x03, 0xff, 0xff, 0x1f, 0xc0, 0xff, 
	0xc0, 0x07, 0xff, 0xfe, 0x00, 0x40, 0xff, 0x80, 0x0f, 0xff, 0xfe, 0x00, 0x40, 0xff, 0x00, 0x1f, 
	0x80, 0x3c, 0x00, 0x40, 0xfe, 0x00, 0x1f, 0x80, 0x3f, 0xff, 0xc0, 0xfc, 0x00, 0x3f, 0x80, 0x7f, 
	0xff, 0xc0, 0xf8, 0x00, 0x3f, 0xf8, 0x7f, 0xff, 0xc0, 0xf8, 0x00, 0x3f, 0xf8, 0xff, 0xff, 0xc0, 
	0xf0, 0x00, 0x3f, 0xf1, 0xff, 0xff, 0xc0, 0xe0, 0x00, 0x7f, 0xe1, 0xff, 0xff, 0xc0, 0xe0, 0x00, 
	0x7f, 0xe0, 0x3f, 0xff, 0xc0, 0xe0, 0x00, 0x7f, 0xc0, 0x3f, 0xff, 0xc0, 0xc0, 0x00, 0x7f, 0xc0, 
	0x3f, 0xff, 0xc0, 0xc0, 0x00, 0x7f, 0xff, 0xff, 0xff, 0xc0, 0xc0, 0x00, 0x7f, 0xff, 0xff, 0xff, 
	0xc0, 0x80, 0x00, 0x3f, 0xff, 0xe0, 0x3f, 0xc0, 0x80, 0x00, 0x3f, 0xff, 0xe0, 0x3f, 0xc0, 0x80, 
	0x00, 0x3f, 0xff, 0xe0, 0x7f, 0xc0, 0x80, 0x00, 0x3f, 0xff, 0xf8, 0x7f, 0xc0, 0x80, 0x00, 0x1f, 
	0xff, 0xf8, 0xff, 0xc0, 0x80, 0x00, 0x1f, 0xff, 0xf0, 0x1f, 0xc0, 0x80, 0x00, 0x0f, 0xff, 0xf0, 
	0x1f, 0xc0, 0x80, 0x00, 0x07, 0xff, 0xe0, 0x1f, 0xc0, 0x80, 0x00, 0x03, 0xff, 0xff, 0xff, 0xc0, 
	0xc0, 0x00, 0x03, 0xff, 0xff, 0xff, 0xc0, 0xc0, 0x00, 0x00, 0xff, 0xff, 0xff, 0xc0, 0xc0, 0x00, 
	0x00, 0x7f, 0xff, 0xff, 0xc0, 0xc0, 0x00, 0x00, 0x1f, 0xff, 0xef, 0xc0, 0xe0, 0x00, 0x00, 0x07, 
	0xff, 0x8f, 0xc0, 0xe0, 0x00, 0x00, 0x00, 0x30, 0x1f, 0xc0, 0xf0, 0x00, 0x00, 0x00, 0x00, 0x1f, 
	0xc0, 0xf0, 0x00, 0x00, 0x00, 0x00, 0x3f, 0xc0, 0xf8, 0x00, 0x00, 0x00, 0x00, 0x7f, 0xc0, 0xfc, 
	0x00, 0x00, 0x00, 0x00, 0x7f, 0xc0, 0xfe, 0x00, 0x00, 0x00, 0x00, 0xff, 0xc0, 0xff, 0x00, 0x00, 
	0x00, 0x01, 0xff, 0xc0, 0xff, 0x80, 0x00, 0x00, 0x03, 0xff, 0xc0, 0xff, 0xc0, 0x00, 0x00, 0x07, 
	0xff, 0xc0, 0xff, 0xe0, 0x00, 0x00, 0x1f, 0xff, 0xc0, 0xff, 0xf8, 0x00, 0x00, 0x3f, 0xff, 0xc0, 
	0xff, 0xfe, 0x00, 0x01, 0xff, 0xff, 0xc0, 0xff, 0xff, 0xc0, 0x0f, 0xff, 0xff, 0xc0
};